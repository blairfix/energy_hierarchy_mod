stats = fread("k_stats.csv")
library(data.table)
library(ggplot2)
library(grid)
library(gtable)
library(gridExtra)
library(magrittr)
library(scales)
library(magrittr)
library(zoo)
library(here)
dir = here()
text.size = 10
# get mean and P025, P975
get.summary = function(x){
p = as.numeric(quantile(x, probs = c(0.025, 0.5, 0.975)))
names(p) <- c("P025", "P50", "P975")
return(p)
}
##########################################################################################
# gini
wd = gsub("Figures", "Data/IPUM", dir)
setwd(wd)
stats = fread("k_stats.csv")
stats = stats[Year < 2015]
stats = stats[Year < 2015]
source('~/Desktop/Supplementary Material/Figures/ipum_trends.R')
library(here)
dir = here()
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
compustat = fread("compustat.txt")
library(hmod)
library(magrittr)
library(data.table)
library(lattice)
library(scatterplot3d)
library(microbenchmark)
library(ggplot2)
library(grid)
library(here)
dir = here()
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
compustat = fread("compustat.txt")
wd = gsub("Figures", "Hierarchy Model/data", dir)
setwd(wd)
compustat = fread("compustat.txt")
s = fread("s_empirical.txt")
g = fread("g_empirical.txt")
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_cap_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_cap_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_cap_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_cap_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_cap_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/k_frac.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/mod_landscape.R')
source('~/Desktop/Empirical Research/Papers/hierarchy_capitalist/Supplementary Materials/Figures/cap_mod.R')
library(data.table)
library(ggplot2)
library(grid)
library(gtable)
library(gridExtra)
library(magrittr)
library(scales)
library(magrittr)
library(zoo)
library(here)
dir = here()
text.size = 10
# get mean and P025, P975
get.summary = function(x){
p = as.numeric(quantile(x, probs = c(0.025, 0.5, 0.975)))
names(p) <- c("P025", "P50", "P975")
return(p)
}
##########################################################################################
# gini
wd = gsub("Figures", "Data/IPUM", dir)
setwd(wd)
stats = fread("capitalist_income_stats.csv.csv")
stats = stats[Year < 2015]
stats = fread("capitalist_income_stats.csv")
stats = stats[Year < 2015]
gini= stats[, as.list(get.summary(Gini)), by = Year]
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
View(gini)
View(stats)
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
lorenz = fread("capitalist_income_lorenz.csv")
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
lorenz = fread("capitalist_income_lorenz.csv")
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
lorenz.us = fread("capitalist_income_lorenz.csv") %>% na.omit()
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/ipum_trends.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/cap_mod_fudge.R')
library(data.table)
library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(gtable)
library(magrittr)
library(zoo)
library(here)
f = function(x){
q = quantile(x, probs = c(0.025, 0.5, 0.975))
names(q) <- c('lower', 'median', 'upper')
return(q)
}
text.size = 10
dir = here()
# gini index
####################################################
wd = gsub("Figures", "Data/CPS/Data", dir)
setwd(wd)
d = fread("Final_data.csv")
total = d[Characteristic == "Total"]
g.census = total$`Gini ratio`
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
g.mod = fread("gini_counterfact.csv")
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
g.mod = fread("gini.csv")
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
ineq_irs = fread("inequality.csv")
View(g.mod)
View(g.mod)
library(data.table)
library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(gtable)
library(magrittr)
library(zoo)
library(here)
f = function(x){
q = quantile(x, probs = c(0.025, 0.5, 0.975))
names(q) <- c('lower', 'median', 'upper')
return(q)
}
text.size = 10
dir = here()
# gini index
####################################################
wd = gsub("Figures", "Data/CPS/Data", dir)
setwd(wd)
d = fread("Final_data.csv")
total = d[Characteristic == "Total"]
g.census = total$`Gini ratio`
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
g.mod = fread("gini.csv")
View(g.mod)
library(data.table)
library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(gtable)
library(magrittr)
library(zoo)
library(here)
f = function(x){
q = quantile(x, probs = c(0.025, 0.5, 0.975))
names(q) <- c('lower', 'median', 'upper')
return(q)
}
text.size = 10
dir = here()
# gini index
####################################################
wd = gsub("Figures", "Data/CPS/Data", dir)
setwd(wd)
d = fread("Final_data.csv")
total = d[Characteristic == "Total"]
g.census = total$`Gini ratio`
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
g.mod = fread("gini.csv")
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
ineq_irs = fread("inequality.csv")
g = rbind(
data.table(gini = g.census, source = "US (CPS)"),
data.table(gini = ineq_irs$gini, source = "US (IRS)"),
data.table(gini = g.mod$V1, source = "Model")
)
g_box = ggplot() +
geom_boxplot(data = g, aes(y = gini, x = source, fill = source), outlier.shape = NA, alpha = 0.5) +
scale_y_continuous(breaks = seq(0, 1, 0.05)) +
coord_cartesian(ylim = c(0.4, 0.62)) +
scale_fill_manual(values = c("Model" = "dodgerblue3", "US (CPS)" = "red", "US (IRS)" = "red")) +
labs(x = "Model Type", y = "Gini Index") +
ggtitle("A.  Gini Index") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times"))
wd = gsub("Figures", "Data/Top_1", dir)
setwd(wd)
t1_us = fread("Top1.csv")
t1_us = t1_us[year >= 1992]
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
t1.mod = fread("top1.csv")
t1 = rbind(
data.table(Top1 = t1_us$top1, source = "US"),
data.table(Top1 = t1.mod$V1, source = "Model")
)
t1_box = ggplot() +
geom_boxplot(data = t1, aes(y = Top1, x = source, fill = source), outlier.shape = NA, alpha = 0.5) +
labs(x = "Model Type", y = "Fraction of Total Income") +
scale_fill_manual(values = c("Model" = "dodgerblue3", "US" = "red" )) +
coord_cartesian(ylim = c(0.07, 0.25)) +
ggtitle("B.  Top 1% Income Share") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times"))
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
alpha_us = fread("alpha.csv")
wd = gsub("Figures", "Hierarchy Model/results", dir)
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
alpha.mod = fread("alpha.csv")
ks.test(alpha.mod$V1, alpha_us$alpha)
t.test(alpha.mod$V1, alpha_us$alpha)
a = rbind(
data.table(alpha = alpha_us$alpha, source = "US"),
data.table(alpha = alpha.mod$V1, source = "Model")
)
alpha_box = ggplot() +
geom_boxplot(data = a, aes(y = alpha, x = source, fill = source), outlier.shape = NA, alpha = 0.5) +
labs(x = "Model Type", y = expression(alpha)) +
scale_fill_manual(values = c("Model" = "dodgerblue3", "US" = "red")) +
scale_y_continuous(breaks = seq(0, 5, 0.25)) +
coord_cartesian(ylim = c(2.25, 3.15)) +
ggtitle("C.  Power-Law Exponent") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
axis.title.x = element_blank(),
axis.title.y = element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times")) +
annotate("text", label = "Calculated on Top 1% of Incomes", x = 1.5, y = 3.1, family = "Times", size = 2.5)
wd = gsub("Figures", "Data/CPS", dir)
setwd(wd)
pdf_us = fread("CPS_density.csv")
pdf_us = pdf_us[, as.list(summary(density)), by = income]
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
pdf_mod = fread("pdf.csv")
pdf_mod = apply(pdf_mod, 2, f) %>% t() %>% data.table()
pdf_mod$breaks = seq(0, 5, length.out = 1000)
pdf_plot = ggplot() +
geom_ribbon(data = pdf_mod, aes(x = breaks, ymin = lower, ymax = upper), alpha = 0.2, fill = "dodgerblue3") +
geom_line(data = pdf_mod, aes(x = breaks, y = median ), col = "dodgerblue3") +
geom_ribbon(data = pdf_us, aes(x = income, ymin = Min., ymax = Max.), alpha = 0.2, fill = "red") +
geom_line(data = pdf_us, aes(x = income, y = Median), col = "red") +
scale_x_continuous("Normalized Income (mean = 1)") +
scale_y_continuous("Density") +
coord_cartesian(xlim = c(0,4), ylim = c(0, 1.6)) +
ggtitle("D.  Probability Density") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.2, 0.8),
legend.box.just = "left",
legend.key.size = unit(0.6, "cm"),
legend.text = element_text(size = rel(0.8)),
legend.title = element_blank(),
axis.title.x=element_text(vjust=-0.3, size=rel(0.9)),
axis.title.y=element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times"))
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
lorenz.us = fread("lorenz.csv")
p = seq(0, 1, 0.001)
lorenz.interp = function(x, y){
approx(x, y, p)
}
lorenz.us = lorenz.us[, lorenz.interp(percentile, income_frac), by = year] %>% na.omit()
lorenz.us = lorenz.us[, as.list(summary(y)), by = x]
zeros = matrix(0, ncol = 7, nrow = 1) %>% data.table()
names(zeros) <- names(lorenz.us)
lorenz.us = rbind(zeros, lorenz.us)
equality = data.table(x = seq(0,1, 0.1), y = seq(0, 1, 0.1))
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
lorenz = fread("lorenz.csv")
odd = seq(1, length(lorenz$V1), 2)
quantile = lorenz[odd] %>% as.matrix() %>% t() %>% as.vector()
even = seq(2, length(lorenz$V1), 2)
income_share =  lorenz[even] %>% as.matrix() %>% t() %>% as.vector()
id = rep(1:nrow(lorenz), each =  ncol(lorenz))
lorenz.mod = data.table(quantile, income_share, id)
lorenz.mod = lorenz.mod[, lorenz.interp(quantile, income_share), by = id] %>% na.omit()
lorenz.mod = lorenz.mod[, as.list(f(y)), by = x]
lorenz.plot = ggplot() +
geom_ribbon(data = lorenz.mod, aes(x = x, ymin = lower, ymax = upper), alpha = 0.2, fill = "dodgerblue3") +
geom_line(data = lorenz.mod, aes(x = x, y = median ), col = "dodgerblue3") +
geom_line(data = equality, aes(x = x, y = y)) +
geom_ribbon(data = lorenz.us, aes(x = x, ymin = Min., ymax = Max.), fill = "red", alpha = 0.2) +
geom_line(data = lorenz.us, aes(x = x, y = Median), col = "red") +
scale_x_continuous("Income Percentile") +
scale_y_continuous("Cumulative Fraction of Income") +
ggtitle("E.  Lorenz Curve") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.2, 0.8),
legend.box.just = "left",
legend.key.size = unit(0.6, "cm"),
legend.text = element_text(size = rel(0.8)),
legend.title = element_blank(),
axis.title.x=element_text(vjust=-0.3, size=rel(0.9)),
axis.title.y=element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times"))
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
cdf.us = fread("cdf_normalize.csv") %>% na.omit()
cdf.us = cdf.us[, as.list(summary(n_frac_adj)), by = upper_norm]
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
lorenz = fread("lorenz.csv")
odd = seq(1, length(lorenz$V1), 2)
cdf.mod = lorenz[odd]
even = seq(2, length(cdf.mod$V1), 2)
breaks = exp(seq(log(0.01), log(1000), length.out = 200))
quants = t(apply(cdf.mod, 2, f))
cdf.mod = data.table(breaks, quants)
cdf_plot = ggplot() +
geom_ribbon(data = cdf.mod, aes(x = breaks, ymin = lower, ymax = upper), alpha = 0.2, fill = "dodgerblue3") +
geom_line(data = cdf.mod, aes(x = breaks, y = median ), col = "dodgerblue3") +
geom_ribbon(data = cdf.us, aes(x = upper_norm, ymin = Min., ymax = Max.), alpha = 0.2, fill = "red") +
geom_line(data = cdf.us, aes(x = upper_norm, y = Median), col = "red") +
coord_cartesian(xlim = c(0.01, 100)) +
scale_x_log10("Normalized Income (mean = 1)", breaks = c(0.01, 0.1, 1, 10, 100), labels  = c(0.01, 0.1, 1, 10, 100) ) +
scale_y_continuous("Cumulative Proportion") +
ggtitle("F.  Cumulative Distribution") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.2, 0.8),
legend.box.just = "left",
legend.key.size = unit(0.6, "cm"),
legend.text = element_text(size = rel(0.8)),
legend.title = element_blank(),
axis.title.x=element_text(vjust=-0.3, size=rel(0.9)),
axis.title.y=element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times"))
wd = gsub("Figures", "Data/IRS", dir)
setwd(wd)
ccdf.us = fread("ccdf_normalize.csv") %>% na.omit()
closest = function(x){
which.min( abs(x - 0.01)  )
}
index = ccdf.us[, .I[closest(n_frac_adj)], by = year]
top1 = ccdf.us[index$V1, ]
top1 = top1$lower_norm[1]
ccdf.us = ccdf.us[, as.list(summary(n_frac_adj)), by = lower_norm]
wd = gsub("Figures", "Hierarchy Model/results", dir)
setwd(wd)
lorenz = fread("lorenz.csv")
ccdf.mod = 1- lorenz[odd]
breaks = exp(seq(log(0.01), log(1000), length.out = 200))
quants = t(apply(ccdf.mod, 2, f))
ccdf.mod = data.table(breaks, quants)
ccdf_plot = ggplot() +
geom_rect(aes( xmin = top1, xmax = 10^3, ymin = 1e-5, ymax = 10), alpha = 0.2,  fill = "grey") +
geom_ribbon(data = ccdf.mod, aes(x = breaks, ymin = lower, ymax = upper), alpha = 0.2, fill = "dodgerblue3") +
geom_line(data = ccdf.mod, aes(x = breaks, y = median ), col = "dodgerblue3") +
geom_ribbon(data = ccdf.us, aes(x = lower_norm, ymin = Min., ymax = Max.), alpha = 0.2, fill = "red") +
geom_line(data = ccdf.us, aes(x = lower_norm, y = Median), col = "red") +
coord_cartesian(xlim = c(0.01, 200), ylim = c(0.0001, 1)) +
scale_x_log10("Normalized Income (mean = 1)", breaks = c(0.01, 0.1, 1, 10, 100), labels  = c(0.01, 0.1, 1, 10, 100) ) +
scale_y_log10("Cumulative Proportion", breaks = trans_breaks("log10",
function(x) 10^x, n=6), labels = trans_format("log10", math_format(10^.x))) +
ggtitle("G.  Complementary Cumulative Distribution") +
theme_bw() +
theme(panel.border = element_rect(color = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.2, 0.8),
legend.box.just = "left",
legend.key.size = unit(0.6, "cm"),
legend.text = element_text(size = rel(0.8)),
legend.title = element_blank(),
axis.title.x=element_text(vjust=-0.3, size=rel(0.9)),
axis.title.y=element_text(vjust= 1.1, size=rel(0.9)),
axis.text.x = element_text(margin=margin(5,5,0,0,"pt")),
axis.text.y = element_text(margin=margin(3,5,0,3,"pt")),
axis.ticks.length = unit(-0.7, "mm"),
plot.title = element_text(face="bold", size = rel(1), hjust = 0.5, margin=margin(b = 0, unit = "pt")),
axis.line = element_line(color = "black"),
text=element_text(size = text.size, family="Times")) +
annotate("text", label = "Top 1% (approximate)", x = 40, y = 1, family = "Times", size = 2.5)
legend = ggplot() +
geom_ribbon(data = pdf_mod, aes(x = breaks, ymin = lower, ymax = upper, fill = "Model 95% Range"), alpha = 0.2 ) +
geom_line(data = pdf_mod, aes(x = breaks, y = median, col = "Model Median" )) +
geom_ribbon(data = pdf_us, aes(x = income, ymin = Min., ymax = Max., fill = "United States Range (1994-2015)"), alpha = 0.2) +
geom_line(data = pdf_us, aes(x = income, y = Median, col = "United States Median")) +
scale_color_manual(values = c("Model Median" = "dodgerblue3", "United States Median" = "red" ) ) +
scale_fill_manual(values = c("Model 95% Range" = "dodgerblue3", "United States Range (1994-2015)" = "red" ) ) +
coord_cartesian(xlim = c(1,4), ylim = c(100, 200)) +
theme_void() +
theme(panel.border = element_rect(color = "black"),
legend.position = "top",
legend.title = element_blank(),
plot.margin = margin(3, 0 , -15, 0, "pt"),
text=element_text(size = text.size, family="Times"))
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
alpha.mod = fread("alpha.csv")
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/mod_properties.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/k_frac_vs_percentile.R')
k_frac_plot
source('~/Desktop/RRPE revision/Supplementary Materials/Data/WID/capitalist_fraction.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Data/WID/capitalist_fraction.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/k_frac_vs_percentile.R')
k_frac_plot
source('~/Desktop/RRPE revision/Supplementary Materials/Data/WID/capitalist_fraction.R')
source('~/Desktop/RRPE revision/Supplementary Materials/Figures/k_frac_vs_percentile.R')
k_frac_plot
